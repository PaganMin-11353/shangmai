{{ define "main" }}
<article class="section">
    <div class="container">
        <!-- Breadcrumb Navigation -->
        <nav aria-label="Breadcrumb" style="margin-bottom: var(--space-8);">
            <ol style="display: flex; align-items: center; gap: var(--space-2); list-style: none; padding: 0; font-size: var(--font-size-sm); color: var(--color-text-muted);">
                <li>
                    <a href="{{ .Site.BaseURL }}" style="color: var(--color-secondary);">{{ i18n "breadcrumb_home" }}</a>
                </li>
                {{ if .Section }}
                <li style="display: flex; align-items: center; gap: var(--space-2);">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/>
                    </svg>
                    <a href="/{{ .Section }}/" style="color: var(--color-secondary);">{{ .Section | title }}</a>
                </li>
                {{ end }}
                <li style="display: flex; align-items: center; gap: var(--space-2);">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/>
                    </svg>
                    <span>{{ .Title }}</span>
                </li>
            </ol>
        </nav>
        
        <!-- Article Header -->
        <header style="margin-bottom: var(--space-12);">
            <div style="max-width: 800px;">
                <h1 style="font-size: var(--font-size-4xl); font-weight: var(--font-weight-bold); margin-bottom: var(--space-6); line-height: var(--line-height-tight);">
                    {{ .Title }}
                </h1>
                
                {{ if .Params.description }}
                <p style="font-size: var(--font-size-xl); color: var(--color-text-secondary); margin-bottom: var(--space-6); line-height: var(--line-height-relaxed);">
                    {{ .Params.description }}
                </p>
                {{ end }}
                
                <!-- Meta Information -->
                <div style="display: flex; flex-wrap: wrap; gap: var(--space-6); font-size: var(--font-size-sm); color: var(--color-text-muted); margin-bottom: var(--space-8);">
                    {{ if .Date }}
                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
                        </svg>
                        <time datetime="{{ .Date.Format "2006-01-02" }}">
                            {{ .Date.Format "January 2, 2006" }}
                        </time>
                    </div>
                    {{ end }}
                    
                    {{ if .Params.author }}
                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                        </svg>
                        <span>{{ i18n "by_author" }} {{ .Params.author }}</span>
                    </div>
                    {{ end }}
                    
                    {{ if .Params.reading_time }}
                    <div style="display: flex; align-items: center; gap: var(--space-2);">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        <span>{{ .Params.reading_time }} {{ i18n "min_read" }}</span>
                    </div>
                    {{ end }}
                </div>
                
                <!-- Tags -->
                {{ if .Params.tags }}
                <div style="display: flex; flex-wrap: wrap; gap: var(--space-2); margin-bottom: var(--space-8);">
                    {{ range .Params.tags }}
                    <a href="/tags/{{ . | urlize }}/" 
                       class="product-tag" 
                       style="text-decoration: none; transition: all var(--transition-fast);"
                       onmouseover="this.style.backgroundColor='var(--color-secondary)'; this.style.color='white';"
                       onmouseout="this.style.backgroundColor='var(--color-background-secondary)'; this.style.color='var(--color-text-muted)';">
                        #{{ . }}
                    </a>
                    {{ end }}
                </div>
                {{ end }}
            </div>
        </header>
        
        <!-- Featured Image -->
        {{ if .Params.image }}
        <div style="margin-bottom: var(--space-12);">
            <div style="border-radius: var(--radius-2xl); overflow: hidden; box-shadow: var(--shadow-lg);">
                <img src="{{ .Params.image }}" 
                     alt="{{ .Title }}" 
                     style="width: 100%; height: 400px; object-fit: cover;"
                     loading="eager">
            </div>
        </div>
        {{ end }}
        
        <!-- Article Content -->
        <div style="display: grid; grid-template-columns: 1fr 300px; gap: var(--space-12); align-items: start;">
            <!-- Main Content -->
            <div class="content" style="max-width: none;">
                {{ .Content }}
            </div>
            
            <!-- Sidebar -->
            <aside style="position: sticky; top: calc(var(--header-height) + var(--space-6));">
                <!-- Table of Contents -->
                {{ if .TableOfContents }}
                <div class="card" style="margin-bottom: var(--space-6);">
                    <h3 style="font-size: var(--font-size-lg); margin-bottom: var(--space-4);">{{ i18n "table_of_contents" }}</h3>
                    <div style="font-size: var(--font-size-sm);">
                        {{ .TableOfContents }}
                    </div>
                </div>
                {{ end }}
                
                <!-- Share Buttons -->
                <div class="card" style="margin-bottom: var(--space-6);">
                    <h3 style="font-size: var(--font-size-lg); margin-bottom: var(--space-4);">{{ i18n "share_this" }}</h3>
                    <div style="display: flex; gap: var(--space-3);">
                        <a href="https://twitter.com/intent/tweet?url={{ .Permalink }}&text={{ .Title }}" 
                           target="_blank" 
                           rel="noopener"
                           class="btn btn-sm btn-outline"
                           style="flex: 1; justify-content: center;">
                            Twitter
                        </a>
                        <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ .Permalink }}" 
                           target="_blank" 
                           rel="noopener"
                           class="btn btn-sm btn-outline"
                           style="flex: 1; justify-content: center;">
                            LinkedIn
                        </a>
                    </div>
                </div>
                
                <!-- Related Articles -->
                {{ $related := .Site.RegularPages.Related . | first 3 }}
                {{ if $related }}
                <div class="card">
                    <h3 style="font-size: var(--font-size-lg); margin-bottom: var(--space-4);">{{ i18n "related_articles" }}</h3>
                    <div style="display: flex; flex-direction: column; gap: var(--space-4);">
                        {{ range $related }}
                        <article style="display: flex; gap: var(--space-3); align-items: start;">
                            {{ if .Params.image }}
                            <img src="{{ .Params.image }}" 
                                 alt="{{ .Title }}" 
                                 style="width: 60px; height: 60px; object-fit: cover; border-radius: var(--radius-lg); flex-shrink: 0;">
                            {{ end }}
                            <div>
                                <h4 style="font-size: var(--font-size-sm); margin-bottom: var(--space-1); line-height: var(--line-height-tight);">
                                    <a href="{{ .RelPermalink }}" style="color: var(--color-text-primary); text-decoration: none;">
                                        {{ .Title }}
                                    </a>
                                </h4>
                                <p style="font-size: var(--font-size-xs); color: var(--color-text-muted); margin: 0;">
                                    {{ .Date.Format "Jan 2, 2006" }}
                                </p>
                            </div>
                        </article>
                        {{ end }}
                    </div>
                </div>
                {{ end }}
            </aside>
        </div>
        
        <!-- Product Specifications (for product pages) -->
        {{ if and (eq .Section "products") .Params.specifications }}
        <section style="margin-top: var(--space-16); padding: var(--space-8); background-color: var(--color-background-secondary); border-radius: var(--radius-2xl);">
            <h2 style="font-size: var(--font-size-2xl); margin-bottom: var(--space-6);">{{ i18n "technical_specifications" }}</h2>
            <div class="grid grid-cols-2" style="gap: var(--space-4);">
                {{ range .Params.specifications }}
                <div style="display: flex; justify-content: space-between; padding: var(--space-3) 0; border-bottom: 1px solid var(--color-border);">
                    <strong style="color: var(--color-text-primary);">{{ .name }}</strong>
                    <span style="color: var(--color-text-secondary);">{{ .value }}</span>
                </div>
                {{ end }}
            </div>
        </section>
        {{ end }}
        
        <!-- Navigation -->
        <nav style="margin-top: var(--space-16); padding-top: var(--space-8); border-top: 1px solid var(--color-border);" aria-label="{{ i18n "article_navigation" }}">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: var(--space-4);">
                {{ if .PrevInSection }}
                <a href="{{ .PrevInSection.RelPermalink }}" 
                   class="btn btn-outline"
                   style="max-width: 250px;">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" style="margin-right: var(--space-2);">
                        <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                    </svg>
                    <span style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                        {{ .PrevInSection.Title }}
                    </span>
                </a>
                {{ else }}
                <div></div>
                {{ end }}
                
                <a href="/{{ .Section }}/" class="btn btn-primary">
                    {{ printf (i18n "back_to_section") (.Section | title) }}
                </a>
                
                {{ if .NextInSection }}
                <a href="{{ .NextInSection.RelPermalink }}" 
                   class="btn btn-outline"
                   style="max-width: 250px;">
                    <span style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                        {{ .NextInSection.Title }}
                    </span>
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" style="margin-left: var(--space-2);">
                        <path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/>
                    </svg>
                </a>
                {{ else }}
                <div></div>
                {{ end }}
            </div>
        </nav>
    </div>
</article>
{{ end }}

<style>
/* Enhanced Content Styling */
.content {
    font-size: var(--font-size-lg);
    line-height: var(--line-height-relaxed);
}

.content h2,
.content h3,
.content h4,
.content h5,
.content h6 {
    margin-top: var(--space-12);
    margin-bottom: var(--space-4);
    scroll-margin-top: calc(var(--header-height) + var(--space-4));
}

.content h2 {
    font-size: var(--font-size-2xl);
    padding-bottom: var(--space-2);
    border-bottom: 2px solid var(--color-border);
}

.content h3 {
    font-size: var(--font-size-xl);
}

.content p {
    margin-bottom: var(--space-6);
}

.content ul,
.content ol {
    margin-bottom: var(--space-6);
    padding-left: var(--space-6);
}

.content li {
    margin-bottom: var(--space-2);
}

.content blockquote {
    border-left: 4px solid var(--color-secondary);
    padding-left: var(--space-6);
    margin: var(--space-8) 0;
    font-style: italic;
    color: var(--color-text-secondary);
    background-color: var(--color-background-secondary);
    padding: var(--space-6);
    border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
}

.content code {
    background-color: var(--color-background-secondary);
    padding: var(--space-1) var(--space-2);
    border-radius: var(--radius-base);
    font-family: var(--font-family-mono);
    font-size: var(--font-size-sm);
}

.content pre {
    background-color: var(--color-gray-900);
    color: var(--color-white);
    padding: var(--space-6);
    border-radius: var(--radius-lg);
    overflow-x: auto;
    margin: var(--space-8) 0;
}

.content pre code {
    background: none;
    padding: 0;
    color: inherit;
}

.content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-lg);
    margin: var(--space-8) 0;
    box-shadow: var(--shadow-md);
}

.content table {
    width: 100%;
    border-collapse: collapse;
    margin: var(--space-8) 0;
    font-size: var(--font-size-base);
}

.content th,
.content td {
    padding: var(--space-3) var(--space-4);
    border: 1px solid var(--color-border);
    text-align: left;
}

.content th {
    background-color: var(--color-background-secondary);
    font-weight: var(--font-weight-semibold);
}

/* Table of Contents Styling */
.content nav#TableOfContents ul {
    list-style: none;
    padding-left: 0;
}

.content nav#TableOfContents ul ul {
    padding-left: var(--space-4);
    margin-top: var(--space-2);
}

.content nav#TableOfContents a {
    display: block;
    padding: var(--space-1) 0;
    color: var(--color-text-secondary);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.content nav#TableOfContents a:hover {
    color: var(--color-secondary);
}

/* Responsive Design */
@media (max-width: 1024px) {
    .content {
        font-size: var(--font-size-base);
    }
    
    article > div > div {
        grid-template-columns: 1fr;
    }
    
    aside {
        position: static;
        order: -1;
    }
    
    .card {
        margin-bottom: var(--space-4);
    }
}

@media (max-width: 768px) {
    .content h2 {
        font-size: var(--font-size-xl);
    }
    
    .content h3 {
        font-size: var(--font-size-lg);
    }
    
    nav[aria-label="Article navigation"] > div {
        flex-direction: column;
        text-align: center;
    }
    
    nav[aria-label="Article navigation"] .btn {
        max-width: none;
        width: 100%;
    }
}

/* Print Styles */
@media print {
    aside {
        display: none;
    }
    
    nav[aria-label="Article navigation"] {
        display: none;
    }
    
    .content {
        max-width: none;
    }
}

/* Focus States for Accessibility */
.content a:focus-visible {
    outline: 2px solid var(--color-secondary);
    outline-offset: 2px;
    border-radius: var(--radius-base);
}
</style>